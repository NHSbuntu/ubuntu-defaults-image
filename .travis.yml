sudo: required
language: generic
services:
- docker
before_install:
- openssl aes-256-cbc -K $encrypted_d422b1704e6e_key -iv $encrypted_d422b1704e6e_iv
  -in travisci_rsa.enc -out travisci_rsa -d
jobs:
  include:
  - stage: amd64
    script:
    - docker pull nhsbuntu/ubuntu-defaults-image:latest
    - docker run --env BUILDARCH=amd64 --rm -it -v `pwd`:`pwd` -w `pwd` --name buildamd64
      --privileged nhsbuntu/ubuntu-defaults-image /bin/bash -c "./build.sh"
  - stage: i386
    script:
    - docker pull nhsbuntu/ubuntu-defaults-image:latest
    - docker run --env BUILDARCH=i386 --rm -it -v `pwd`:`pwd` -w `pwd` --name buildi386
      --privileged nhsbuntu/ubuntu-defaults-image /bin/bash -c "./build.sh"
env:
  global:
  - secure: oKNZopM7iBrrhgEZGmdqFVH9iGEOi6HV/PO4IftYgCVrUayKBWQFjwhVfeyMpncOPls2MBC/f9ms5zBYL1tP2nCNQ8UZ/0D9295hWNVEO5FxdoLRlh1yaVr106lB8XwGc/mYACIGffXLPipsdDgIr8J6M+BKiiI9LYKkoiNmg6LsakIU9R6WBtJOi+kZwDCOJ4Hviy+dOdkJC9eiWLxhhMsJO2asEX06iRVDST0crN29FyY8eQBQo8n8TOCPP8xYTmSl9ss8grOkFzbbJDcoDF/B/7gHiykLQZbTqfGIKniNZt+ymWSCL4OXZ9hS2UtbBektvzITlTEtBdTMM9rwOEYVifeY2wS9c9NZbs1EdRy7mH0XfjiF3cZ3mpKY4t6GnvDHROMmjWwFQ6Qdp8FeboSxLJxQxcYXJQw2saQgu3a6lhc0FTTl9r7w3eexmdxt3pRya3yHRyRKgQwb5fO+IoVpmgm8nXgv2TL/ZXcdP6n0fEm5VuAV6b7cBidID5HVPuSKYm5REmwuJ4AgtrQbdTsBeVH078HHvoWndxgG5Xoef6lEtZu1FfNrH/uvFYoIVjy+BDoYGxcwlZAm7kheBuP8sxM5oEzxvqt/YJFVj77/s8StV5ho20Cg0l1gDp9d5e134R/2ipzQfh/Jd+7CrZwYTt0TQ7TP8myvTZ3Aa1k=
  - secure: IlYKwU6c5p/u1SiaHevRl6ovh+CBDhq/wC5dBwOZFYKL036qNKY2lRvvKMoHrtM4hNOZlb8AgJ+2/77aNzfCLGURHe8QCZwr/ZCqlAEPtFYFODU8rAGojpa0CqF9/yKXAoIldLS5QOvj9wqOw+jxYOW1s/D8yr28orBneUJUorkOosL13awPr+xO+CxnO/+9wxdjjqQE2s4VXevDgICSp7nBzMB3TtabY3mXWEPVDPLIW6dFaE9w6CPKREeexcWZN54P7tySdp6e/mAi/nyKO9KXk21VYhbEnAuSrNhNV9KhP3j+D94gQ8ClFBOn1F54zxUMr65q73JKkR8URaXQPD0HSNW0njDHpJUexlvPbQ7D6o5niehZwwFAY0OtJKPg5z55xv3uQzT9Jk0Dc6HZ59HcX9dwVV2voOyioTtJfvgon+KplQsObsX0tX9aSPxecTSQdEV20fy+NLH4hbPgI5cgJjuhf4o09dKOI+XDgtCrQk6kiWfuBJzi7ZL6ufqjKhm1cOHX8QDDeURMO2GQDnGedcKurM7m2FQV5M5em2D3uaPgfkDkgCdCGx89AAFTMxyLsveJHkDs6Qifu7oY9iRVDf7rZ6khEWDqsu+7OaOI18k/1feqonx4lYZNh8qz2BHySX6oe2FRJi3WbbViR4xNDHgiyVDz5dhqZTZhFhA=
  - secure: ZXckEDj74MXF7EHRNtk0HNpx9BdGE/uUJNTE3+/N6h4cJm2v6zRW6En0ezxtA3OUfOEbVnXnYi9Pa70CLxCqKLSPjMl2ukp/NlCy4TZ3C4uMHcA+1oBuxFNkCpKqLzltaPiLJ/S8WqJcd0fAlkjc1RIUPYRjGM1J1g6aRBcDcQcUNpkJQs06hVmefdatC3fVL0A96T6QQD8PfF76ge+nfphsOzT4V7WM6wrNw19To86g7v9p03UUgaoolH4aERgKDGqpkiFSSACOSjdipDjv6hX4+hU9NLS/RHttq4G5RqiJ05LpP/HkacLOHIl4MDjYE8h4fvoWOV9sCPdr8cWqxOjTU7pxNoFGi9mcNuQZavCM7Ynb80fqIROC02aWDWubQ5tw2E3FtZyU5zDDm3hbzCW9wgsohhQ79fBIqvYKJp8eIjA+54ueQQ3uA57L0hS6ZUYzchSm5dn13sagtrWpv7FxHqF+As/rWicmZGzeCFs8Zw936gWpikqiFIuEl9E8AyACw6I2bGZ2+qakDvII+5aHXH4IYBcXOnXSJR4m+cHcbq2A0lFBfsPFFjRPAeJfsvVSGPnqG9Javd2xJKuE61TgS193Js6BdP8lsYbttNXe9rtJePe4sblyqUD7ZJFUZ/L7okUFM8U94M883CLWJWtogYK+onNzHh8I9PJT5QY=
  - secure: d3zntUo1KNvqBlF1yHM5QiEziV+7QzDYmasX8Vdutb2aewROFthlSbaetctlu4Ww4Q7tTlQQYGYtPrKzWAMuyRuUYfW+yJIHjil/KKgrGb5Gsze6k/x4I7h0kgj0tVC6e0xXNEi904hYaHkWGVCAuq5tsbBlSXde0nc0NxqN6nozGR4RqBXYUJS0ofwsSf3lHZf6MFixxjKkwAUo+CwySj/wgK+oPHm+bL8eWhJMabhdJDx3CvOnPz6uHYXrDFo6NQHXWw/F0OEHmIb8a60Zw1SX7xK+84XxBA/IwssJKxcQuLiY/vcvNeQ5Y160XoBtMGLhjFCuRYGyWqEqJye/xO4olXbixgZhKMHNrc+o5JHV4NfuVBvfuqs3+9m/1L4/yxu9C7lmIECDGcBS+GS9TKMDEZuqv0I7mCHf/lyH0TTZDXO7iQ41xq57Wx6Hh6SGGO4tbrfcnWorEqbaklLS/h1/6rmd2ggduw46yNef0p9GqbJ5IrY7o6A6x6PYp0aA+M4rBgDu9Vp+uFFDQMnfVU2ElfVO6noCZoEZONyxmY/uhYm2B/2w8UVQTT/GLgKdcHHFZA70QZPib1KG7n5xGop+KT/uKmj5NMoqqH834wZdt6yTY6OEkx5jX7HULcR6Ne2opLeSHvijKNB7Ged5dYBwEIScStI6F9EseO0SV3Q=
after_success:
- eval "$(ssh-agent -s)"
- chmod 600 travisci_rsa
- ssh-add travisci_rsa
- scp -o stricthostkeychecking=no NHSbuntu-amd64* $deployuser@$deployhost:/120GB/ISO/amd64
- scp -o stricthostkeychecking=no NHSbuntu-i386* $deployuser@$deployhost:/120GB/ISO/i386
notifications:
  slack:
    secure: r1DhvwOVcxN7JmfBkSF389VhGGUa7UDnG/M+LcxasINe2VV2ymemaxEoVbeDF4unXtwc5xImuYQUxtLs0Q+SmIMAUl0dggv/5quw5gw9hiURdmyC6JPtgDZDPAZ4GUiRFstWhqpRW1n07hHDaSkQOmFJxpTP/mtm80BamXsKYGrW6z/PekcbmDzhfWZk1zAnJTsrNuYFA+Ii9Cv6kUbwEYKlF2axArpcQ7kvOcGY/a6YB36JVxmMmNf6zlTipUka5BUyH5HAUr4eGOwiZ3Flba55/SxDPzFcWO7reLreypjeM471qFpTVOnXmaKH7G3lFunPGu/LIX2hSIUjnrM1E51cNBPeI6cfExoOsH9p0lvDtu191kHnRjWDKyTEJLmmfR5Ibe4UcsYIMxUfE1jNrks1qLxvwKHVBVeFP76RohyzJfg+x/cMQMay76l2TR2+NihaBxoZH+Wjx+2OPvhdVZzyPPWhY/iiSxORlkP7Ad4XMj4FLgbY3fLjvKmaOC+AO8h5i/ZFSoXJ4vCOSFbLFpjAR8dOp8tYAofMDjriT4zXN90Z/+oPRmA8djkEcMXmdMZAHd6hbAd+KK2MwzOHaBAqpmHZKs0gx2tUtJwAc6XKL3RhBq9GIel0IwGnRf4v9xQ3bcMZLUMeAVq/r7f9bQMXyTXI7jVmMLCw5xWEs/g=
